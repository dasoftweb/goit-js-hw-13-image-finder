{"version":3,"sources":["webpack:///./templates/imagesListTemplate.hbs","webpack:///./js/settings.js","webpack:///./js/api.js","webpack:///./index.js"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","nullContext","program","noop","BASE_URL","setting","API_KEY","ImagesApi","selector","this","element","document","querySelector","currentPage","totalPages","query","per_page","search","console","log","fetchImages","then","results","images","hits","totalHits","loadMore","addImages","newImages","searchQuery","page","url","fetch","response","json","renderImages","innerHTML","imagesListTemplate","imagesList","imagesSearch","inputRef","observerRef","addEventListener","_","debounce","value","observerHandler","IntersectionObserver","observe"],"mappings":"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","file":"main.cd200ee56e5882dea955.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"gallery__item\\\">\\r\\n    <div class=\\\"photo-card\\\">\\r\\n        <img src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" alt=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"tags\") : depth0), depth0))\n    + \"\\\" />\\r\\n\\r\\n        <div class=\\\"stats\\\">\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"likes\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">visibility</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"views\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">comment</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"comments\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n        </div>\\r\\n    </div>\\r\\n</li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"\\r\\n\"\n    + ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":15,\"column\":0},\"end\":{\"line\":40,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});","export default {\r\n  BASE_URL: 'https://pixabay.com/api/',\r\n  API_KEY: '20663729-402ac0755ef01966534e76e9d',\r\n};\r\n\r\n","import setting from '../js/settings';\r\nimport imagesListTemplate from '../templates/imagesListTemplate.hbs';\r\n\r\nconst { BASE_URL, API_KEY } = setting;\r\n\r\nclass ImagesApi {\r\n  #images = [];\r\n  constructor(selector) {\r\n    this.element = document.querySelector(selector);\r\n    this.currentPage = 1;\r\n    this.totalPages = 0;\r\n    this.#images = [];\r\n    this.query = '';\r\n    this.per_page = 12;\r\n  }\r\n\r\n  get images() {\r\n    return this.#images;\r\n  }\r\n\r\n  set images(imagesList) {\r\n    this.#images = imagesList;\r\n    this.renderImages();\r\n  }\r\n\r\n  search(query) {\r\n    if (!query) {\r\n      return;\r\n    }\r\n\r\n    if (this.query != query) {\r\n      this.query = query;\r\n      this.currentPage = 1;\r\n      this.totalPages = 0;\r\n    }\r\n    console.log(`NEW QUERY`);\r\n    console.log(`Load Page: ${this.currentPage}`);\r\n\r\n    this.fetchImages(query, this.currentPage).then(results => {\r\n      this.images = results.hits;\r\n      this.totalPages = results.totalHits / this.per_page;\r\n      //   console.log(results);\r\n      //   console.log(this.totalPages);\r\n    });\r\n  }\r\n\r\n  loadMore() {\r\n    if (!this.query) {\r\n      return;\r\n    }\r\n\r\n    if (this.totalPages <= this.currentPage) {\r\n      return;\r\n    }\r\n\r\n    this.currentPage += 1;\r\n    console.log(`Load Page: ${this.currentPage}`);\r\n\r\n    this.fetchImages(this.query, this.currentPage).then(results => {\r\n      this.addImages(results.hits);\r\n    });\r\n  }\r\n\r\n  addImages(newImages) {\r\n    this.images = [...this.images, ...newImages];\r\n  }\r\n\r\n  async fetchImages(searchQuery, page) {\r\n    const url = `${BASE_URL}?image_type=photo&orientation=horizontal&q=${searchQuery}&page=${page}&per_page=${this.per_page}&key=${API_KEY}`;\r\n    const response = await fetch(url);\r\n    const images = response.json();\r\n    return images;\r\n  }\r\n\r\n  renderImages() {\r\n    this.element.innerHTML = imagesListTemplate(this.images);\r\n  }\r\n}\r\n\r\nexport default ImagesApi;\r\n","import './styles.css';\nimport debounce from 'lodash';\nimport ImagesApi from './js/api';\nimport 'material-design-icons/iconfont/material-icons.css';\n\nconst imagesSearch = new ImagesApi('.gallery');\nconst inputRef = document.querySelector('input[name=\"query\"]');\nconst observerRef = document.querySelector('.gallery-load-observer');\n\ninputRef.addEventListener(\n  'input',\n  _.debounce(() => {\n    imagesSearch.search(inputRef.value);\n  }, 1000),\n);\n\nconst observerHandler = _.debounce(() => {\n  imagesSearch.loadMore();\n//   console.log('Сработал Обс');\n}, 500);\n\nconst observer = new IntersectionObserver(observerHandler);\nobserver.observe(observerRef);\n\n// imagesSearch.search('kiev') // hardcoded search test\n"],"sourceRoot":""}