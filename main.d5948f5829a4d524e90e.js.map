{"version":3,"sources":["webpack:///./templates/imagesListTemplate.hbs","webpack:///./js/settings.js","webpack:///./js/api.js","webpack:///./index.js"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","nullContext","program","noop","BASE_URL","setting","API_KEY","ImagesApi","selector","this","galleryRef","document","querySelector","lightboxRef","lightboxImageRef","lightboxOverlayRef","lightboxCloseRef","currentPage","totalPages","query","per_page","loadMore","bind","onGalleryClick","event","preventDefault","target","nodeName","console","log","imageRef","largeImageURL","dataset","source","largeImageALT","alt","setLightboxImage","openModal","classList","add","closeModal","remove","removeLightboxImage","url","src","search","fetchImages","then","results","images","hits","totalHits","addImages","newImages","searchQuery","page","fetch","response","json","renderImages","innerHTML","imagesListTemplate","imagesList","addEventListener","imagesSearch","inputRef","observerRef","_","debounce","value","observerHandler","IntersectionObserver","observe"],"mappings":"8EAAA,IAAIA,EAAa,EAAQ,QAEzBC,EAAOC,SAAWF,EAAoB,SAAKA,GAAYG,SAAS,CAAC,EAAI,SAASC,EAAUC,EAAOC,EAAQC,EAASC,GAC5G,IAAIC,EAAOL,EAAUM,OAAQC,EAAOP,EAAUQ,iBAAkBC,EAAiBT,EAAUS,gBAAkB,SAASC,EAAQC,GAC1H,GAAIC,OAAOC,UAAUC,eAAeC,KAAKL,EAAQC,GAC/C,OAAOD,EAAOC,IAKtB,MAAO,mFACHJ,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,gBAAkBA,EAASA,IACjF,kBACAM,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,iBAAmBA,EAASA,IAClF,UACAM,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,QAAUA,EAASA,IACzE,8JACAM,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,SAAWA,EAASA,IAC1E,6IACAM,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,SAAWA,EAASA,IAC1E,0IACAM,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,YAAcA,EAASA,IAC7E,iJACAM,EAAOF,EAAkB,MAAVJ,EAAiBQ,EAAeR,EAAO,aAAeA,EAASA,IAC9E,qEACJ,SAAW,CAAC,EAAE,YAAY,KAAO,SAASD,EAAUC,EAAOC,EAAQC,EAASC,GAC1E,IAAIY,EAON,OAA+R,OAAtRA,GAPsBhB,EAAUS,gBAAkB,SAASC,EAAQC,GACtE,GAAIC,OAAOC,UAAUC,eAAeC,KAAKL,EAAQC,GAC/C,OAAOD,EAAOC,KAKWT,EAAQ,QAAQa,KAAe,MAAVd,EAAiBA,EAAUD,EAAUiB,aAAe,GAAIhB,EAAO,CAAC,KAAO,OAAO,KAAO,GAAG,GAAKD,EAAUkB,QAAQ,EAAGd,EAAM,GAAG,QAAUJ,EAAUmB,KAAK,KAAOf,EAAK,IAAM,CAAC,MAAQ,CAAC,KAAO,EAAE,OAAS,GAAG,IAAM,CAAC,KAAO,GAAG,OAAS,OAAiBY,EAAS,IAC/S,SAAU,K,4LClCG,EACH,2BADG,EAEJ,qC,qiBCCHI,EAAsBC,EAAZC,EAAYD,E,cA6HfE,E,WAzHb,WAAYC,GAAU,8BADZ,KAERC,KAAKC,WAAaC,SAASC,cAAcJ,GACzCC,KAAKI,YAAcF,SAASC,cAAc,gBAC1CH,KAAKK,iBAAmBH,SAASC,cAAc,oBAC/CH,KAAKM,mBAAqBJ,SAASC,cAAc,sBACjDH,KAAKO,iBAAmBL,SAASC,cAC/B,wCAEFH,KAAKQ,YAAc,EACnBR,KAAKS,WAAa,EAClB,EAAAT,KAAA,EAAe,IACfA,KAAKU,MAAQ,GACbV,KAAKW,SAAW,GAChBX,KAAKY,SAAWZ,KAAKY,SAASC,KAAKb,M,iCAmBrCc,eAAA,SAAeC,GAEb,GADAA,EAAMC,iBACwB,QAA1BD,EAAME,OAAOC,SAAjB,CAGAC,QAAQC,IAAI,oBACZ,IAAMC,EAAWN,EAAME,OACjBK,EAAgBD,EAASE,QAAQC,OACjCC,EAAgBJ,EAASK,IAC/BP,QAAQC,IAAIE,GACZtB,KAAK2B,iBAAiBL,EAAeG,GACrCzB,KAAK4B,c,EAGPA,UAAA,WACE5B,KAAKI,YAAYyB,UAAUC,IAAI,Y,EAGjCC,WAAA,WACE/B,KAAKI,YAAYyB,UAAUG,OAAO,WAClChC,KAAKiC,uB,EAGPN,iBAAA,SAAiBO,EAAKR,GACpB1B,KAAKK,iBAAiB8B,IAAMD,EAC5BlC,KAAKK,iBAAiBqB,IAAMA,G,EAG9BO,oBAAA,WACEjC,KAAKK,iBAAiB8B,IAAM,GAC5BnC,KAAKK,iBAAiBqB,IAAM,I,EAG9BU,OAAA,SAAO1B,GAAO,WACPA,IAIDV,KAAKU,OAASA,IAEhBV,KAAKU,MAAQA,EACbV,KAAKQ,YAAc,EACnBR,KAAKS,WAAa,GAEpBU,QAAQC,IAAR,aACAD,QAAQC,IAAR,cAA0BpB,KAAKQ,aAE/BR,KAAKqC,YAAY3B,EAAOV,KAAKQ,aAAa8B,MAAK,SAAAC,GAC7C,EAAKC,OAASD,EAAQE,KACtB,EAAKhC,WAAa8B,EAAQG,UAAY,EAAK/B,c,EAM/CC,SAAA,WAAW,WACJZ,KAAKU,QAINV,KAAKS,YAAcT,KAAKQ,cAI5BR,KAAKQ,aAAe,EACpBW,QAAQC,IAAR,cAA0BpB,KAAKQ,aAE/BR,KAAKqC,YAAYrC,KAAKU,MAAOV,KAAKQ,aAAa8B,MAAK,SAAAC,GAClD,EAAKI,UAAUJ,EAAQE,Y,EAI3BE,UAAA,SAAUC,GAER5C,KAAKwC,OAAL,UAAkBxC,KAAKwC,OAAWI,I,EAG9BP,Y,+CAAN,WAAkBQ,EAAaC,GAA/B,iGACQZ,EAASvC,EADjB,8CACuEkD,EADvE,SAC2FC,EAD3F,aAC4G9C,KAAKW,SADjH,QACiId,EADjI,SAEyBkD,MAAMb,GAF/B,cAEQc,EAFR,OAGQR,EAASQ,EAASC,OAH1B,kBAIST,GAJT,+C,yOAOAU,aAAA,WACElD,KAAKC,WAAWkD,UAAYC,IAAmBpD,KAAKwC,S,qCApGpD,O,4IAAA,CAAOxC,KAAP,I,aAGSqD,GACT,EAAArD,KAAA,EAAeqD,GACfrD,KAAKkD,eAELlD,KAAKC,WAAWqD,iBAAiB,QAAStD,KAAKc,eAAeD,KAAKb,OACnEA,KAAKM,mBAAmBgD,iBACtB,QACAtD,KAAK+B,WAAWlB,KAAKb,OAEvBA,KAAKO,iBAAiB+C,iBAAiB,QAAStD,KAAK+B,WAAWlB,KAAKb,Y,gCC/BnEuD,G,UAAe,IAAIzD,EAAU,aAC7B0D,EAAWtD,SAASC,cAAc,uBAClCsD,EAAcvD,SAASC,cAAc,0BAG3CqD,EAASF,iBACP,QACAI,EAAEC,UAAS,WACTJ,EAAanB,OAAOoB,EAASI,SAC5B,MAGL,IAAMC,EAAkBH,EAAEC,UAAS,WACjCxC,QAAQC,IAAI,gBACZmC,EAAa3C,aACZ,KAEc,IAAIkD,qBAAqBD,GAEjCE,QAAQN,K","file":"main.d5948f5829a4d524e90e.js","sourcesContent":["var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<li class=\\\"gallery__item\\\">\\r\\n    <div class=\\\"photo-card\\\">\\r\\n        <img src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" data-source=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \"\\\" alt=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"tags\") : depth0), depth0))\n    + \"\\\" />\\r\\n\\r\\n        <div class=\\\"stats\\\">\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"likes\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">visibility</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"views\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">comment</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"comments\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n            <p class=\\\"stats-item\\\">\\r\\n                <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n                \"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0), depth0))\n    + \"\\r\\n            </p>\\r\\n        </div>\\r\\n    </div>\\r\\n</li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":26,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});","export default {\r\n  BASE_URL: 'https://pixabay.com/api/',\r\n  API_KEY: '20663729-402ac0755ef01966534e76e9d',\r\n};\r\n\r\n","import setting from '../js/settings';\r\nimport imagesListTemplate from '../templates/imagesListTemplate.hbs';\r\n\r\nconst { BASE_URL, API_KEY } = setting;\r\n\r\nclass ImagesApi {\r\n  #images = [];\r\n  constructor(selector) {\r\n    this.galleryRef = document.querySelector(selector);\r\n    this.lightboxRef = document.querySelector('.js-lightbox');\r\n    this.lightboxImageRef = document.querySelector('.lightbox__image');\r\n    this.lightboxOverlayRef = document.querySelector('.lightbox__overlay');\r\n    this.lightboxCloseRef = document.querySelector(\r\n      'button[data-action=\"close-lightbox\"]',\r\n    );\r\n    this.currentPage = 1;\r\n    this.totalPages = 0;\r\n    this.#images = [];\r\n    this.query = '';\r\n    this.per_page = 12;\r\n    this.loadMore = this.loadMore.bind(this);\r\n  }\r\n\r\n  get images() {\r\n    return this.#images;\r\n  }\r\n\r\n  set images(imagesList) {\r\n    this.#images = imagesList;\r\n    this.renderImages();\r\n    // render lightbox stuff\r\n    this.galleryRef.addEventListener('click', this.onGalleryClick.bind(this));\r\n    this.lightboxOverlayRef.addEventListener(\r\n      'click',\r\n      this.closeModal.bind(this),\r\n    );\r\n    this.lightboxCloseRef.addEventListener('click', this.closeModal.bind(this));\r\n  }\r\n\r\n  onGalleryClick(event) {\r\n    event.preventDefault();\r\n    if (event.target.nodeName !== 'IMG') {\r\n      return;\r\n    }\r\n    console.log('Click on gallery');\r\n    const imageRef = event.target;\r\n    const largeImageURL = imageRef.dataset.source;\r\n    const largeImageALT = imageRef.alt;\r\n    console.log(largeImageURL);\r\n    this.setLightboxImage(largeImageURL, largeImageALT);\r\n    this.openModal();\r\n  }\r\n\r\n  openModal() {\r\n    this.lightboxRef.classList.add('is-open');\r\n  }\r\n\r\n  closeModal() {\r\n    this.lightboxRef.classList.remove('is-open');\r\n    this.removeLightboxImage();\r\n  }\r\n\r\n  setLightboxImage(url, alt) {\r\n    this.lightboxImageRef.src = url;\r\n    this.lightboxImageRef.alt = alt;\r\n  }\r\n\r\n  removeLightboxImage() {\r\n    this.lightboxImageRef.src = '';\r\n    this.lightboxImageRef.alt = '';\r\n  }\r\n\r\n  search(query) {\r\n    if (!query) {\r\n      return; //no query\r\n    }\r\n\r\n    if (this.query != query) {\r\n      //new quert = reset contants\r\n      this.query = query;\r\n      this.currentPage = 1;\r\n      this.totalPages = 0;\r\n    }\r\n    console.log(`NEW QUERY`);\r\n    console.log(`Load Page: ${this.currentPage}`);\r\n\r\n    this.fetchImages(query, this.currentPage).then(results => {\r\n      this.images = results.hits;\r\n      this.totalPages = results.totalHits / this.per_page;\r\n      //   console.log(results);\r\n      //   console.log(this.totalPages);\r\n    });\r\n  }\r\n\r\n  loadMore() {\r\n    if (!this.query) {\r\n      return;\r\n    }\r\n\r\n    if (this.totalPages <= this.currentPage) {\r\n      return;\r\n    }\r\n\r\n    this.currentPage += 1;\r\n    console.log(`Load Page: ${this.currentPage}`);\r\n\r\n    this.fetchImages(this.query, this.currentPage).then(results => {\r\n      this.addImages(results.hits);\r\n    });\r\n  }\r\n\r\n  addImages(newImages) {\r\n    // add new images to old images\r\n    this.images = [...this.images, ...newImages];\r\n  }\r\n\r\n  async fetchImages(searchQuery, page) {\r\n    const url = `${BASE_URL}?image_type=photo&orientation=horizontal&q=${searchQuery}&page=${page}&per_page=${this.per_page}&key=${API_KEY}`;\r\n    const response = await fetch(url);\r\n    const images = response.json();\r\n    return images;\r\n  }\r\n\r\n  renderImages() {\r\n    this.galleryRef.innerHTML = imagesListTemplate(this.images);\r\n  }\r\n}\r\n\r\nexport default ImagesApi;\r\n","import './styles.css';\nimport debounce from 'lodash';\nimport ImagesApi from './js/api';\nimport 'material-design-icons/iconfont/material-icons.css';\n\nconst imagesSearch = new ImagesApi('.gallery');\nconst inputRef = document.querySelector('input[name=\"query\"]');\nconst observerRef = document.querySelector('.gallery-load-observer');\n// const loadMoreBtnRef = document.querySelector('#load-more');\n\ninputRef.addEventListener(\n  'input',\n  _.debounce(() => {\n    imagesSearch.search(inputRef.value);\n  }, 1000),\n);\n\nconst observerHandler = _.debounce(() => {\n  console.log('Сработал Обс');\n  imagesSearch.loadMore();\n}, 500);\n\nconst observer = new IntersectionObserver(observerHandler);\n\nobserver.observe(observerRef);\n\n// loadMoreBtnRef.addEventListener('click', imagesSearch.loadMore);\n// imagesSearch.search('kiev') // hardcoded search test\n"],"sourceRoot":""}